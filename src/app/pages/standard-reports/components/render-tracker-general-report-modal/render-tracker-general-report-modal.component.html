<div
  class="w-100 d-flex no-print"
  style="height: 50px; border-bottom: solid 1px #eee; padding: 15px"
>
  <!-- <span>Report</span> -->
  <div class="w-50 d-flex justify-content-left">
    <button
      title="Print as PDF document"
      class="download-btns"
      mat-button
      (click)="printPDF($event)"
    >
      <img
        height="20"
        title="Print to PDF"
        width="30"
        src="assets/icons/print.png"
      />
    </button>
    <button
      title="Download as Word document"
      mat-button
      class="ml-2 download-btns"
      (click)="download($event, 'report', dataToRender[0]?.reportHeader)"
    >
      <!-- Download to Word -->
      <img
        height="20"
        title="Download to Word"
        width="30"
        src="assets/icons/word.png"
      />
    </button>
  </div>
  <div class="w-50 d-flex justify-content-end">
    <button
      style="margin-top: -10px"
      mat-icon-button
      mat-dialog-close
      matTooltip="close"
    >
      <mat-icon>close</mat-icon>
    </button>
  </div>
</div>
<mat-dialog-content class="mat-typography p-3">
  <div class="h4 text-center">
    <img height="80" src="assets/img/logo_lhrc.png" />
  </div>
  <div id="report" #report>
    <div
      class="w-100"
      style="padding: 15px 30px; margin-bottom: 20px"
      *ngFor="let formattedTrackedEntityInstanceData of dataToRender"
      [ngStyle]="{
        'border-bottom': dataToRender.length > 1 ? 'solid 2px #3ea9d9' : 'none'
      }"
    >
      <div class="h3 text-center">
        <b> Legal and Human Rights Center - Tanzania </b>
      </div>
      <div class="h4 text-center">
        <b>
          {{ formattedTrackedEntityInstanceData?.reportHeader }}
        </b>
      </div>
      <div
        class="text-justify"
        *ngFor="
          let otherDetail of formattedTrackedEntityInstanceData?.otherDetails
        "
      >
        <p class="text-justify">
          <b>{{ otherDetail?.name }}:</b>{{ otherDetail?.value }}
        </p>
      </div>
      <div class="stages">
        <div
          *ngFor="let stage of program?.programStages"
          style="padding: 15px 2px"
        >
          <div
            class="h5 text-left w-100"
            style="border-bottom: solid 1px #eee; margin-bottom: 5px"
          >
            <b>
              {{ stage?.name }}
            </b>
          </div>
          <div
            *ngIf="formattedTrackedEntityInstanceData[stage?.id]?.length === 0"
          >
            <p class="text-left">No data</p>
          </div>
          <div
            class="w-100"
            style="overflow: auto"
            *ngIf="formattedTrackedEntityInstanceData[stage?.id]?.length > 0"
          >
            <table class="table table-bordered">
              <thead>
                <tr>
                  <th>SN</th>
                  <th
                    class="text-center"
                    *ngFor="
                      let programStageDataElement of stage?.programStageDataElements
                    "
                  >
                    {{ programStageDataElement.dataElement.name }}
                  </th>
                  <th>Reported by</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="
                    let dataRow of formattedTrackedEntityInstanceData[
                      stage?.id
                    ];
                    let count = index
                  "
                >
                  <td>
                    {{ count + 1 }}
                  </td>
                  <td
                    *ngFor="
                      let programStageDataElement of stage?.programStageDataElements
                    "
                  >
                    {{
                      dataRow?.keyedDataValues[
                        programStageDataElement?.dataElement?.id
                      ]
                        ? dataRow?.keyedDataValues[
                            programStageDataElement?.dataElement?.id
                          ]?.value
                        : ''
                    }}
                  </td>
                  <td>
                    {{ dataRow.storedBy }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <img
    width="100%"
    style="margin-top: 40px"
    height="50"
    src="assets/img/footer_banner_lhrc.png"
  />
</mat-dialog-content>
